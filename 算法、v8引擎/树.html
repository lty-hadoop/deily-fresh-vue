<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>document</title>
	<style>
		* {
			margin: 0;
			padding: 0;
		}	
		ul {
			position: relative;
			padding-left: 40px;
		}
		ul li {
			list-style: none;
		}
		ul li p {
			height: 25px;
			line-height: 25px;
		}
		ul li p::after {
			content: "";
			position: absolute;
			left: 10px;
			top: 0;
			width: 1px;
			height: 13px;
			background: #000;
		}
		ul li p::before {
			content: "";
			position: absolute;
			left: 10px;
			top: 13px;
			width: 25px;
			height: 1px;
			background: #000;
		}
	</style>
</head>
<body>
	<div class="tree-wrap">
		<p class="aa">
			<span>235</span>
		</p>
		<div>水电费</div>
	</div>
	<script>
		var arr = [
			{
				"name": "张三",
				"children": [
					{
						"name": "张三222",
						"children": [
							{
								"name": "张三333"
							}
						]
					}
				]
			},
			{"name": "小明"},
			{
				"name": "john",
				"children": [
					{
						"name": "john22"
					}
				]
			}
		]

		function Init() {
			document.querySelector('.tree-wrap').innerHTML = tree(arr)
		}
		Init()

		function tree(data) {
			let str = `<ul>`
			for(let i = 0; i < data.length; i++){
				str += `<li>`;
				str += `<p data-flag="true" onClick="checkNode(event)">${data[i].name}</p>`;
				if(data[i].children && data[i].children.length) {
					str += tree(data[i].children);
				}
				str += `</li>`;
			}

			str += `</ul>`
			return str
		}
		
		// 检查元素并展开折叠
		function checkNode(event) {
			var flag = event.target
			// 获取当前点击DOM的同级元素标签
			var oSibling = event.target.nextSibling;
			if(!!oSibling && !!oSibling.childNodes) {
				var oChild = Array.prototype.slice.call(oSibling.childNodes);
				for(var i = 0; i < oChild.length; i++){
					// 表示非文本节点
					if(oChild[i].nodeType === 1){
						if(getData(flag.getAttribute('data-flag'))) {
							flag.setAttribute("data-flag", false)
							oChild[i].style.display = 'none'
						} else {
							flag.setAttribute("data-flag", true)
							oChild[i].style.display = 'block'
						}
					}
				}
			}
		}

		// JQ源码转换自定义属性
		function getData(data) {
			if ( data === "true" ) {
				return true;
			}

			if ( data === "false" ) {
				return false;
			}

			if ( data === "null" ) {
				return null;
			}

			return data;
		}
	</script>
</body>
</html>